% Chapter 6

\chapter{Derivate} % Chapter title

\label{ch:derivate} % For referencing the chapter elsewhere, use \autoref{ch:name}

%----------------------------------------------------------------------------------------

\section{Rette nel piano}
Dato un punto $P_0=(x_0,y_0)\in\R^2$ le rette passanti per $P_0$ hanno equazione:
\[y=m(x-x_0)+y_0 \qquad \text{oppure } \qquad x=x_0 \text{ retta verticale},\]
dove $m=tan\theta$ è il coefficiente angolare e $\theta\in(\frac{-\pi}{2},\frac{\pi}{2})$ è l'angolo che la retta forma con la retta $y=y_0$, parallela all'asse delle ascisse.

Dati due punti $P_0=(x_0,y_0)$ e $P_1=(x_1,y_1)$, la retta passante per $P_0$ e $P_1$ ha equazione:
\begin{equation*}\begin{cases}
y=\frac{y_1-y_0}{x_1-x_0}(x-x_0)+y_0 \qquad x_0\neq x_1 \\
x=x_0 \qquad \qquad x_0=x_1
\end{cases}\end{equation*}

Data una funzione $f:I\rightarrow\R$ definita su intervallo $I$ ed $x_0\neq x_1 \in I$, l'equazione della retta secante il grafico di $f$ nei punti $P_0=(x_0,f(x_0))$ e $P_1=(x_1,f(x_1))$ è:
\[y=\frac{f(x_1)-f(x_0)}{x_1-x_0}(x-x_0)+f(x_0).\]

In particolare, la retta secante non è parallela all'asse delle ordinate ed il suo coefficiente angolare è:
\[m=\frac{f(x_1)-f(x_0)}{x_1-x_0}.\]

\section{Derivata e retta tangente}
Data una funzione $f:I\rightarrow\R$ definita su un intervallo $I$
\begin{aenumerate}
	\item fissato $x_0\in I$, si dice che $f$ è derivabile in $x_0$ se esiste finito:
	\[\lim_{h\to0}{\frac{f(x_0+h)-f(x_0)}{h}}=:f^\prime(x_0),\]
	il valore del limite$f^\prime(x_0)$ si chiama derivata della funzione $f$ nel punto $x_0$.
	\item la funzione $f$ si dice derivabile se è derivabile in $x_0$ per ogni $x_0\in I$ e la funzione:
	\[f^\prime : I\rightarrow\R \qquad y=f^\prime(x),\]
	è detta derivata prima.
\end{aenumerate}

\paragraph*{Nota} La definizione di funzione derivabile si estende al caso di funzioni definite su un unione di intervalli disgiunti.

\section{Derivate delle funzioni elementari}
\begin{equation*}
\begin{array}{ |*{4}{c|} }
\toprule
f(x) & & f^\prime(x) & I \\
\midrule
x^b & b\in\R        & bx^{b-1} & (0,+\infty) \\
c   & c\in\R        & 0        & \R          \\
x^n & n\in\N,n\geq1 & nx^{n-1} & \R          \\
\frac{1}{x^n}=x^{-n} & n\in\N,n\geq1 & -n\frac{1}{x^{n+1}} & \R \backslash\{0\} \\
\sqrt[n]{x} = x^{\frac{1}{n}} & n\in\N,n\geq1 & \frac{1}{n} x^{\frac{1-n}{n}} & n\text{ pari}(0,+\infty),n \text{ dispari} \R\backslash\{0\} \\
\midrule
\e^x & & \e^x & \R \\
a^x & a>0 & \log a \text{ } a^x & \R \\
\log x & & \frac{1}{x} & (0,+\infty) \\
\log_a x & a>0,a\neq 1 & \frac{1}{\log a}\frac{1}{x} & (0,+\infty) \\
\midrule
\sin x & & \cos x & \R \\
\cos x & & -\sin x & \R \\
\tan x & & \frac{1}{\cos^2 x}=1+\tan^2 x & \R\backslash\{\frac{\pi}{2}+k\pi | k\in \Z\} \\
\midrule
\arcsin x & & \frac{1}{\sqrt{1-x^2}} & (-1,1) \\
\arccos x & & \frac{-1}{\sqrt{1-x^2}} & (-1,1) \\
\arctan x & & \frac{1}{1+x^2} & \R \\
\bottomrule
\end{array}
\end{equation*}

\paragraph{Osservazione.}
Se si pone $h=x-x_0$ la definizione di derivata diventa:
\[f^\prime(x_0)=\lim_{x\to x_0} \frac{f(x)-f(x_0)}{x-x_0},\]
dove è inteso che il limite esiste finito. La quantità:
\[\frac{f(x)-f(x_0)}{x-x_0}=\frac{f(x_0+h)-f(x_0)}{h},\]
è detta rapporto incrementale della funzione ed è il coefficiente angolare della retta secante il grafico di $f(x)$ nei punti $P_0=(x_0,f(x_0))$ e $P_h=(x_0+h,f(x_0+h))$.

Facendo tendere $h$ a zero, il punto $P_h$ tente a $P_0$ e la corrispondente retta secante converge alla retta tangente, se $f$ è derivabile.

Ne segue che l'equazione della retta tangente al grafico di $f(x)$ nel punto $P_0=(x_0,f(x_0))$ è:
\[y=f^\prime(x_0)(x-x_0)+f(y_0)\]
In particolare la derivata $f^\prime(x_0)$ rappresenta il coefficiente angolare della retta tangente. 

\section{Derivata destra e sinistra}
Data una funzione $f:I\rightarrow \R$ definita su un intervallo $I$ di estremo sinistro $a\in\R\cup \{-\infty\}$ ed estremo destro $b\in\R\cap \{+\infty\}$, ed un punto $x_0 \neq a$, se esiste finito:
\begin{equation*}
\lim_{x\to x_0^-}{\frac{f(x)-f(x_0)}{x-x_0}} =: f^\prime_-(x_0)
\end{equation*}

Il valore $f^\prime_-(x_0)$ si chiama derivata sinistra. Se $x_0\neq b$ se esiste finito:

\begin{equation*}
\lim_{x\to x_0^+}{\frac{f(x)-f(x_0)}{x-x_0}} =: f^\prime_+(x_0)
\end{equation*}

\paragraph{Osservazione.}
Data una funzione $f:I\rightarrow \R$ definita su un intervallo $I$ di estremo sinistro $a\in \R \cup \{-\infty\}$ ed estremo destro $b\in\R\cap \{+\infty\}$, ed un punto $x_0\in I, x_0 \neq a , x_0 \neq b$, allora sono fatti equivalenti:
\begin{aenumerate}
\item la funzione $f$ è derivabile in $x_0$;
\item la funzione $f$ ammette derivata sinistra e destra in $x_0$ e sono uguali tra loro.
\end{aenumerate}
In tal caso
\begin{equation*}
f^\prime(x_0)=f^\prime_-(x_0) = f^\prime_+(x_0)
\end{equation*}

\section{Proprietà delle funzioni derivabili.}
\begin{teo}[Continuità funzioni derivabili.]
Sia: $f:I\rightarrow\R$ una funzione definita su un intervallo $I$. Se $f(x)$ è derivabile in $x_0\in I$, allora $f(x)$ è continua in $x_0$.
Da notare che esistono funzioni continue non derivabili come $f(x) = |x|$.
\end{teo}

\begin{teo}[Algebra delle funzioni derivabili.]
Date due funzioni $f,g:I\rightarrow\R$ definite su un intervallo $I$ e derivabili, allora:
\begin{aenumerate}
\item dati $\alpha,\beta \in\R$ la combinazione lineare $\alpha f(x)+\beta g(x)$ è derivabile e vale
\[(\alpha f(x)+\beta g(x))^\prime = \alpha f^\prime(x) + \beta g^\prime(x);\]
in particolare:
\[ (\alpha f(x))^\prime = \alpha f^\prime(x) \qquad (f(x)+g(x))^\prime=f^\prime(x)+g^\prime(x).\]
\item il prodotto $f(x)g(x)$ è derivabile e vale:
\[(f(x)g(x))^\prime = f^\prime(x)g(x)+f(x)g^\prime(x);\]
\item se $g(x)\neq 0$ per ogni $x\in I$, allora il rapporto $\frac{f(x)}{g(x)}$	è derivabile e vale:
\[\left(\frac{f(x)}{g(x)}\right)^\prime = \frac{f^\prime g(x)-f(x)(x)g^\prime(x)}{g(x)^2},\]
in particolare:
\[\left( \frac{1}{g(x)} \right)^\prime = - \frac{g^\prime(x)}{g(x)^2}.\]
\end{aenumerate}
\end{teo}

\begin{teo}[Derivata funzione composta.]
Date due funzioni $f:I\rightarrow\R, y=f(x), g:J\rightarrow\R, z=g(y)$, dove $I$ e $J$ sono due intervalli, tali che:
\begin{aenumerate}
\item per ogni $x\in I$ allora $f(x)\in J$
\item le funzioni $f$ e $g$ sono derivabili
\end{aenumerate}
allora la funzione composta $g \circ f: I\rightarrow \R, z=g(f(x))$, è derivabile e:
\[g(f(x))^\prime=g^\prime(f(x))f^\prime(x) \text{     regola di derivazione in catena.}\]
\end{teo}

\section{Derivata funzione inversa}
Data una funzione $f:I \rightarrow \R$ tale che:
\begin{aenumerate}
\item il dominio $I$ è un intervallo;
\item $f$ è iniettiva;
\item $f$ è derivabile;
\item per ogni $x\in I, f^\prime(x) \neq 0 $
\end{aenumerate}
allora, posto $J=\im f$, la funzione inversa $f^{-1}:J\rightarrow\R$è derivabile e:
\[(f^{-1}(x))^\prime = \frac{1}{f^\prime(f^{-1}(x))}\]

\section{Estremi relativi}
Data una funzione $f:A\rightarrow\R$, un punto $x_0\in A$ è detto punto di estremo relativo se esiste $\delta> 0$ tale che:
\begin{itemize}
\item minimo relativo:
\[f(x)\geq f(x_0) \qquad \forall x\in (x_0 - \delta, x_0 + \delta) \cap A\]
\item massimo relativo:
\[f(x)\leq f(x_0) \qquad \forall x\in (x_0 - \delta, x_0 + \delta) \cap A\]
\end{itemize}
Il valore $f(x_0)$ è detto estremo (minimo/massimo) relativo.

\begin{teo}[Condizione necessaria del I ordine]
Data $f:I\rightarrow\R$ definita su un intervallo $I$ di estremo sinistro $a \in \R \cup\{-\infty\}$ ed estremo destro $b \in \R \cup\{+\infty\}$ ed un punto $x_0\in I$ tali che:
\begin{enumerate}
\item la funzione $f$ è derivabile in $x_0$;
\item $x_0$ è un punto di estremo relativo per $f$;
\item $x_0\neq a$ e $x_0\neq b$;
\end{enumerate}
allora $f^\prime(x_0)=0$.
\paragraph{Osservazione.}
Il teorema assicura che la retta tangente al grafico di $f(x)$ nel punto $P_0 = (x_0,f(x_0))$ è parallela all'asse delle ascisse purchè:
\begin{enumerate}
\item $f$ sia derivabile in $x_0$ e quindi ammette retta tangente;
\item il punto $x_0$ sia di minimo o massimo relativo;
\item $x_0$ non coincida con gli estremi $a$ e $b$, cioè $x_0 \in (a,b)$
\end{enumerate}
\end{teo}

\begin{teo}[Teorema di Lagrange.]
Data una funzione $f:[a,b]\rightarrow \R$ tale che:
\begin{enumerate}
\item $f$ è continua in $x_0$ per ogni $x_0\in[a,b]$;
\item $f$ è derivabile in $x_0$ per ogni $x_0\in(a,b)$;
\end{enumerate}
allora esiste $x_0\in (a,b)$ tale che:
\[f(b)-f(a)=f^\prime(x_0)(b-a).\]
\end{teo}

\paragraph{Osservazione.}
Dal punto di vista grafico, significa che esiste un punto $x_0\in(a,b)$ tale che la retta tangente al grafico di $f(x)$ nel punto $P_0=(x_0,f(x_0))$ è parallela alla retta secante passante per i punti $P_1=(a,f(a))$ e $P_2=(b,f(b))$.

\subparagraph{Nota:} nel caso in cui $f(a)=f(b)$ il teorema di Lagrange implica che esiste $x_0\in (a,b)$ tale che $f^\prime(x_0)$ (teorema di Rolle.)

\begin{teo}[Caratterizzazione monotonia.]
Data $f:I\rightarrow\R$ definita su un intervallo $I$ di estremo sinistro $a\in\R\cup\{-\infty\}$ ed estremo destro $b\in\R\cup\{+\infty\}$ tale che:
\begin{enumerate}
\item $f$ è continua in $x_0$ per ogni $x_0 \in I$;
\item $f$ è derivabile in $x_0$ per ogni $x_0\in (a,b)$;
\end{enumerate}
allora:
\begin{equation*}
\begin{array}{ *{4}{c} }
f^\prime(x) \geq 0 & \forall x \in (a,b) & \Leftrightarrow & f(x) \text{ è crescente su I} \\
f^\prime(x) \leq 0 & \forall x \in (a,b) & \Leftrightarrow & f(x) \text{ è decrescente su I} \\
f^\prime(x) = 0 & \forall x \in (a,b) & \Leftrightarrow & f(x) \text{ è costante su I} \\
f^\prime(x) > 0 & \forall x \in (a,b) & \Leftrightarrow & f(x) \text{ è strettamente crescente su I} \\
f^\prime(x) < 0 & \forall x \in (a,b) & \Leftrightarrow & f(x) \text{ è strettamente decrescente su I} \\
\end{array}
\end{equation*}
\subparagraph{Nota:} Se il dominio nella funzione $f$ non è un intervallo, il segno della derivata prima non permette di caratterizzare la monotonia della funzione. Infatti, se $f(x)=\frac{1}{x}$ con dominio $\R \backslash \{0\}$, la sua derivata $f^\prime(x)=-\frac{1}{x^2}<0$ per ogni $x\neq 0$. Il grafico $f(x)$ è l'iperbole equilatera $xy=1$, per cui la funzione è strettamente decrescente nell'intervallo $(-\infty,0)$ così come nell'intervallo $(0,+\infty)$. Tuttavia non è decrescente sull'unione dei due intervalli $\R \backslash \{0\}$: infatti:
\[f(x_1)<0<f(x_2) \qquad \text{ se } x_1<0<x_2\].
\end{teo}

\section{De l'Hopital}
\begin{teo}[Teorema di De l'Hopital.]
Date due funzioni $f,g:I \backslash \{x_0\} \rightarrow \R$ dove $I$ è un intervallo e $x_0 \in I$ tali che:
\begin{aenumerate}
\item $f$ e $g$ sono derivabili;
\item vale una delle due seguenti condizioni:
\[\lim_{x\to x_0}{f(x)}=\lim_{x\to x_0}{g(x)}=0,\]
\[\lim_{x\to x_0}{f(x)}=\lim_{x\to x_0}{g(x)}=\pm\infty;\]
\item per ogni $x\in I, x\neq x_0$, allora $g^\prime(x)\neq 0$;
\item esiste:
\[\lim_{x\to x_0}{\frac{f^\prime(x)}{g^\prime(x)}}=\ell\in\R\cup\{\pm\infty\};\]
\end{aenumerate}
allora esiste:
\[\lim_{x\to x_0}{\frac{f(x)}{g(x)}}=\ell.\]
\end{teo}

\section{Derivate di ordine successivo}
Una funzione $f:I\rightarrow\R$ su un intervallo $I$ si dice derivabile due volte se:
\begin{aenumerate}
\item la funzione $f$ è derivabile;
\item la derivata prima $f^\prime$ è derivabile;
\end{aenumerate}
inoltre la funzione:
\[f^{\prime\prime}:I\rightarrow\R \qquad f^{\prime\prime}(x)=(f^\prime(x))^\prime\]
si chiama derivata seconda.

In modo analogo si definiscono le derivate di ordine successivo:
\[f^{\prime\prime\prime}=(f^{\prime\prime})^\prime, \quad f^{(4)}= (f^{\prime\prime\prime})^\prime, \quad f^{(k+1)}=(f^{(k)})^\prime, \]
dove l'indice $k\in\N$ è detto ordine di derivazione (se $k=0$ si pone $f^{(0)}=f$).

Notazioni alternative per le derivate sono:
\[f^\prime=\frac{df}{dx},\quad f^{\prime\prime}=\frac{d^2f}{dx^2}, \quad f^{(k)}=\frac{d^kf}{dx^k}\]

Inoltre, si definiscono i seguenti spazi di funzioni:
\[\cc^0(I)=\{f:I\rightarrow\R \mid f\text{ continua}\}\]
\[\cc^1(I)=\{f:I\rightarrow\R \mid f\text{ derivabile ed } f^\prime \text{ continua}\}\]
\[\dots\]
\[\cc^k(I)=\{f:I\rightarrow\R \mid f\text{ derivabile k-volte ed } f^\{(k)\} \text{ continua}\}\]
\[\cc^\infty(I)=\{f:I\rightarrow\R \mid f\text{ ammette derivata k-esima per ogni } k\in\N\}\]
e si definisce $\cc^k(I)$ come lo spazio delle funzioni di classe $\cc^k$ sull'intervallo $I$. Dalle proprietà delle funzioni derivabili segue che $\cc^k(I)$ è uno spazio vettoriale e:
\[\cc^\infty(I) \subsetneq \cc^k(I) \subsetneq \cc^\{k-1\}(I) \subsetneq \cc^1(I) \subsetneq \cc^0(I)\]

\section{Funzioni convesse e concave}
Una funzione $f:I\rightarrow\R$ definita su un intervallo $I$ è detta:
\begin{itemize}
\item convessa se per ogni $x_1,x_2\in I$ e per ogni $t\in[0,1]$
\[f( (1-t)x_1+tx_2)\leq(1-t)f(x_1)+tf(x_2)\]
\item concava se per ogni $x_1,x_2\in I$ e per ogni $t\in[0,1]$
\[f( (1-t)x_1+tx_2)\geq(1-t)f(x_1)+tf(x_2)\]
\end{itemize}
Dal punto di vista geometrico le due condizioni affermano che, dati due punti $P_1=(x_1,f(x_1))$ e $P_2=(x_2,f(x_2))$ sul grafico di $f$, il segmento di estremi $P_1$ e $P_2$ sta sopra il grafico di $f$. Infatti:
\begin{itemize}
\item al variare di $t\in[0,1]$
\[x_t=(1-t)x_1+tx_2=x_1+t(x_2-x_1)\]
descrive i punti sull'asse delle ascisse compresi tra $x_1$ e $x_2$;
\item al variare di $t\in[0,1]$
\[((1-t)x_1+tx_2),f((1-t)x_1+tx_2)=(x_t,f(x_t))\]
parametrizza i punti sul grafico di $f$ compresi tra $P_1$ e $P_2$;
\item al variare di $t\in[0,1]$
\[((1-t)x_1+tx_2),(1-t)f(x_1)+tf(x_2)\]
parametrizza i punti del piano che stanno sul segmento di estremi $P_1$ e $P_2$.
Infatti la retta secante passante per $P_1$ e $P_2$ ha equazione:
\[y=\frac{f(x_2)-f(x_1)}{x_2-x_1}(x-x_1)+f(x_1) \underset{x=x_t}{=}(1-t)f(x_1)+tf(x_2)\]
\end{itemize}

\begin{teo}[Caratterizzazione convessità.]
Data una funzione $f:\rightarrow\R$ definita su un intervallo $I$ e derivabile due vole, sono fatti equivalenti:
\begin{aenumerate}
\item la funzione $f$ è convessa;
\item fissato $x_0 \in I$;
\[f(x)\geq f(x_0)+f^\prime(x_0)(x-x_0) \qquad \text{per ogni }x\in I\]
\item per ogni $x\in I$, $f^{\prime\prime}(x)\geq 0$
\end{aenumerate}
Dal punto di vista geometrico la seconda condizione afferma che, dato un punto qualunque $P_0=(x_0,f(x_0))$ sul grafico di $f$, la retta tangente al grafico di $f$ in $P_0$ sta sotto il grafico di $f$. Un' analoga caratterizzazione vale per le funzioni concave (baste cambiare il verso delle disequazioni).
\end{teo}

\begin{coro}[Condizione sufficiente del secondo ordine per estremi relativi.]
Data una funzione $f:I\rightarrow\R$ definita su un intervallo $I$ e derivabile due volte ed un punto $x_0\in I$:
\begin{equation*}
\begin{array}{ *{3}{c} }
\text{se } f^\prime(x_0)>0 \qquad & \qquad \text{allora} & \qquad x_0 \text{ è un punto di minimo relativo} \\
\text{se } f^\prime(x_0)<0 \qquad & \qquad \text{allora} & \qquad x_0 \text{ è un punto di massimo relativo} \\
\end{array}
\end{equation*}
\end{coro}